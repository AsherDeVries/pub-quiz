{"version":3,"sources":["../../src/websockets/non-quizmaster.js"],"names":["quiznightCode","quiznightNamespace","webSocketServer","of","on","socket","emit","nsp","name","message","console","log","id","update","_id","substr","$push","teams","teamName","roundPoints","then","to"],"mappings":";;;;;;AAAA;;;;AACA;;;;;;kBAEe,UAACA,aAAD,EAAmB;AAChC,MAAIC,qBAAqB,cAAIC,eAAJ,CAAoBC,EAApB,CAAuB,MAAMH,aAA7B,CAAzB;;AAEAC,qBAAmBG,EAAnB,CAAsB,YAAtB,EAAoC,UAACC,MAAD,EAAY;AAC9CA,WAAOC,IAAP,CAAY,SAAZ,2CAA8DD,OAAOE,GAAP,CAAWC,IAAzE;AACA;;AAEAH,WAAOD,EAAP,CAAU,cAAV,EAA0B,UAACK,OAAD,EAAa;AACrCC,cAAQC,GAAR,CAAYN,OAAOO,EAAnB;AACA,0BAAUC,MAAV,CACE,EAAEC,KAAKT,OAAOE,GAAP,CAAWC,IAAX,CAAgBO,MAAhB,CAAuB,CAAvB,CAAP,EADF,EAEE,EAAEC,OAAO,EAAEC,OAAO,EAAEH,KAAKL,QAAQS,QAAf,EAAyBC,aAAa,CAAtC,EAAT,EAAT,EAFF,EAGGC,IAHH,CAGQ,cAAIlB,eAAJ,CAAoBmB,EAApB,CAAuB,iBAAvB,EAA0Cf,IAA1C,CAA+C,SAA/C,EAA0D;AAC9D,+CAAsCG,QAAQS,QAA9C,0BAA2Eb,OAAOO,EAAlF,qDAAoIP,OAAOE,GAAP,CAAWC;AADjF,OAA1D,CAHR;AAMC,KARH;AASC,GAbH;;AAeA,SAAOP,kBAAP;AACD,C","file":"non-quizmaster.js","sourcesContent":["import app from '../app';\nimport Quiznight from '../models/Quiznight';\n\nexport default (quiznightCode) => {\n  let quiznightNamespace = app.webSocketServer.of('/' + quiznightCode);\n\n  quiznightNamespace.on('connection', (socket) => {\n    socket.emit('PENDING', `Welcome to the quiznight with code: ${socket.nsp.name}! Send your teamname to join.`);\n    // TODO: refactor code below to redirect quizmaster to created namespace\n    \n    socket.on('CONNECT_TEAM', (message) => {\n      console.log(socket.id);\n      Quiznight.update(\n        { _id: socket.nsp.name.substr(1) },\n        { $push: { teams: { _id: message.teamName, roundPoints: 0 } } })\n        .then(app.webSocketServer.to('QUIZMASTER_ROOM').emit('PENDING', { \n          'message' : `A new team with name: \"${message.teamName}\" and socket id: \"${socket.id}\" is waiting to join the quiznight with code ${socket.nsp.name}` \n        }));\n      });\n    });\n\n  return quiznightNamespace;\n}"]}