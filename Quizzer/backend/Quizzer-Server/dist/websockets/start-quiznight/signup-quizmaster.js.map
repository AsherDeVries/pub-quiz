{"version":3,"sources":["../../../src/websockets/start-quiznight/signup-quizmaster.js"],"names":["socket","on","credentials","username","quizmaster_credentials","password","quiznightCode","generate","length","charset","qn","_id","teams","rounds","save","err","emit","nsp","join"],"mappings":";;;;;;AAAA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;;;kBAEe,UAACA,MAAD,EAAY;AACzBA,SAAOC,EAAP,CAAU,oBAAV,EAAgC,UAACC,WAAD,EAAiB;AAC/C,QAAGA,YAAYC,QAAZ,KAAyB,iBAAOC,sBAAP,CAA8BD,QAAvD,IACAD,YAAYG,QAAZ,KAAyB,iBAAOD,sBAAP,CAA8BC,QAD1D,EACoE;AAClE,UAAIC,gBAAgB,uBAAaC,QAAb,CAAsB;AACxCC,gBAAQ,CADgC;AAExCC,iBAAS;AAF+B,OAAtB,CAApB;AAIA,UAAIC,KAAK,wBAAc;AACrBC,aAAKL,aADgB;AAErBM,eAAO,EAFc;AAGrBC,gBAAQ;AAHa,OAAd,CAAT;;AAMAH,SAAGI,IAAH,CAAQ,UAACC,GAAD,EAAS;AACf,YAAGA,GAAH,EAAQ;AACNf,iBAAOgB,IAAP,CAAY,SAAZ,yEAA4FV,aAA5F;AACD,SAFD,MAEO;AACL,cAAIW,MAAM,6BAAwBX,aAAxB,CAAV;AACAN,iBAAOkB,IAAP,CAAY,iBAAZ;AACAlB,iBAAOgB,IAAP,CAAY,SAAZ,wEAA2FV,aAA3F;AACD;AACF,OARD;AASD,KArBD,MAqBO;AACLN,aAAOgB,IAAP,CAAY,eAAZ,EAA6B,mBAA7B;AACD;AACF,GAzBD;AA0BD,C","file":"signup-quizmaster.js","sourcesContent":["import config from '../../config.json';\nimport Quiznight from '../../models/Quiznight';\nimport randomstring from 'randomstring';\nimport createSocketIoNamespace from '../non-quizmaster';\nimport app from '../../app';\n\nexport default (socket) => {\n  socket.on('CONNECT_QUIZMASTER', (credentials) => {\n    if(credentials.username === config.quizmaster_credentials.username && \n       credentials.password === config.quizmaster_credentials.password) {\n      let quiznightCode = randomstring.generate({\n        length: 6,\n        charset: 'alphanumeric'\n      });\n      let qn = new Quiznight({\n        _id: quiznightCode,\n        teams: [],\n        rounds: []\n      });\n  \n      qn.save((err) => {\n        if(err) {\n          socket.emit('PENDING', `A quiznight could not be created because of the following reason: ${quiznightCode}`);\n        } else {\n          let nsp = createSocketIoNamespace(quiznightCode);\n          socket.join('QUIZMASTER_ROOM');\n          socket.emit('PENDING', `Welcome quizmaster!, a quiznight has been created with the code: ${quiznightCode}`);\n        }\n      });\n    } else {\n      socket.emit('SIGN_UP_ERROR', 'Wrong credentials');\n    }\n  });\n}"]}